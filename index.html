<!DOCTYPE html><html><head><title>Poe Guide</title><!-- style: include:styl styles/index.styl--><link type="text/css" rel="stylesheet" href="styles/index.css"><script src="//use.typekit.net/ldo1umf.js"></script><script>try{Typekit.load();}catch(e){}</script><script>(function(d) {var config = {kitId: 'ldo1umf', scriptTimeout: 3000}, h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='//use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)})(document);</script></head><body><main><h1><span>Poe Guide</span></h1><hr class="menu-top"><menu><ul><li class="index index-complete">1</li><li class="menuitem menuitem-complete"><a href="#introduction">Introduction</a></li><li class="menuitem menuitem-complete"><a href="#overview">Overview</a></li><li class="menuitem menuitem-complete"><a href="#getting-started">Getting Started</a></li><li class="menuitem menuitem-complete"><a href="#hello-world">Hello World</a></li></ul><ul><li class="index index-undefined">2</li><li class="menuitem menuitem-undefined"><a href="#basic-ui">Basic UI</a></li><li class="menuitem menuitem-complete"><a href="#structure">Structure</a></li><li class="menuitem menuitem-complete"><a href="#markup">Markup</a></li><li class="menuitem menuitem-complete"><a href="#styles">Styles</a></li><li class="menuitem menuitem-complete"><a href="#routes">Routes</a></li></ul><ul><li class="index index-undefined">3</li><li class="menuitem menuitem-undefined"><a href="#basic-api">Basic API</a></li><li class="menuitem menuitem-complete"><a href="#initializing">Initializing</a></li><li class="menuitem menuitem-complete"><a href="#login">Login</a></li><li class="menuitem menuitem-complete"><a href="#mongoose">Mongoose</a></li><li class="menuitem menuitem-incomplete"><a href="#wiring-up">Wiring Up</a></li><!-- +listitem('Front-Ends', 'incomplete')--><!-- +listitem('Contracts', 'incomplete')--><!-- +listitem('Systems', 'incomplete')--></ul><ul><li class="index index-incomplete">4</li><li class="menuitem menuitem-incomplete"><a href="#client-hypermedia">Client Hypermedia</a></li><li class="menuitem menuitem-incomplete"><a href="#data-binding">Data Binding</a></li><li class="menuitem menuitem-incomplete"><a href="#forms">Forms</a></li><li class="menuitem menuitem-incomplete"><a href="#composition">Composition</a></li><li class="menuitem menuitem-incomplete"><a href="#a-front-end">A Front End</a></li></ul><ul><li class="index index-incomplete">5</li><li class="menuitem menuitem-incomplete"><a href="#api-design">API Design</a></li><li class="menuitem menuitem-incomplete"><a href="#hypermedia">Hypermedia</a></li><li class="menuitem menuitem-incomplete"><a href="#specs-and-standards">Specs and Standards</a></li><li class="menuitem menuitem-incomplete"><a href="#a-mock-api">A Mock API</a></li></ul><ul><li class="index index-undefined">6</li><li class="menuitem menuitem-undefined"><a href="#appendix">Appendix</a></li><li class="menuitem menuitem-undefined"><a href="#organizations">Organizations</a></li><li class="menuitem menuitem-undefined"><a href="#resources">Resources</a></li><li class="menuitem menuitem-incomplete"><a href="#credits">Credits</a></li><li class="menuitem menuitem-incomplete"><a href="#license">License</a></li></ul></menu><hr class="menu-bottom"><div class="quotes"><div class="quote"><blockquote class="quote-value"></blockquote><strong class="quote-author"></strong></div></div><h2 id="introduction">Introduction</h2><section id="introduction-section" class="introduction-section"><div id="overview" class="subsection"><h3>Overview</h3><p>  Poe is a collection of open-source tools for web developers, and Poe UI is its front-end framework.</p>
<p>  Let&#39;s start with the basics by generating a skeleton Poe UI app locally.</p>
</div><div id="getting-started" class="subsection"><h3>Getting Started</h3><p>First off, this tutorial assumes a basic familiarity with the terminal, JS/HTML/CSS, and an editor of some kind.
As new concepts are introduced, please check out the resources we provide and revisit as necessary. We will be
focussing on the very highest level features.</p>
<p>Now, to kick things off, we will need <a href="&quot;http://nodejs.org/&quot;">node.js</a>, so install if necessary.</p>
<p>Since we&#39;ll need <a href="https://github.com/ddollar/foreman">foreman</a> as well, you might as well install it too while
you&#39;re at it.</p>
<div class='NOTE'>
<p>
If you&#39;re on OS X, it&#39;s better to install node via <a href="http://brew.sh">homebrew</a> or
use TJ Holowaychuck&#39;s <a href="http://github.com/tj/n">n</a>.
</p>
<p>
Here&#39;s a one-liner to quickly install <code>n</code>:
<pre><code>
(git clone <a href="https://github.com/tj/n.git">https://github.com/tj/n.git</a> /tmp/<em>n</em> &amp;&amp; cd /tmp/<em>n</em> &amp;&amp; make &amp;&amp; n stable)
</code></pre>
</p>
</div>
</div><div id="hello-world" class="subsection"><h3>Hello World</h3><p>In accordance with front-end law, any library that is capable of running a todo list <em>must</em>
demonstrate a todo list app; so that&#39;s what we&#39;ll do.</p>
<p>Start by opening your terminal and installing the <a href="https://github.com/poegroup/poe">poe</a> command line tool.</p>
<pre><code>npm i -g poe
</code></pre><p>After install finishes, navigate to an empty directory somewhere. This will be our app&#39;s root.</p>
<pre><code>mkdir ~/Projects/mndvns/todo-ui
cd ~/Projects/mndvns/todo-ui
poe create ui
</code></pre><p>At this point you&#39;ll be prompted for a project name, description, etc.
Let&#39;s use the following values for out project:</p>
<pre><code>project: todo-ui
description: todo user interface
port: 5000
api url: http://localhost:5001
</code></pre><p>It should then ask for a confirmation that resembles</p>
<pre><code>{
 &quot;project&quot;: &quot;todo-ui&quot;,
 &quot;username&quot;: &quot;mndvns&quot;,
 &quot;email&quot;: &quot;mail@mndvns.com&quot;,
 &quot;fullname&quot;: &quot;Michael Andrew Vanasse&quot;,
 &quot;description&quot;: &quot;todo user interface&quot;,
 &quot;PORT&quot;: &quot;5000&quot;,
 &quot;API_URL&quot;: &quot;http://localhost:5001&quot;
}
</code></pre><p>Agree to proceed, and let it do its thing. Once instantiated, you can start the app by running</p>
<pre><code>make start
</code></pre><div class='WARNING'>
If you receive a warning message, go
<a href="https://github.com/componentjs/guide/blob/master/component/getting-started.md#setup-authentication">here</a>
and ensure your github credentials are exposed properly.
</div>

<p>After a moment to install dependencies, our output should look something like this:</p>
<pre><code>14:38:42 web.1   | started with pid 44663
14:38:42 web.1   |    info : auto-reload enabled
14:38:42 web.1   | Server listening on port 5000
</code></pre><div class='NOTE'>
This log style may look familiar to you; we are using <strong><a href="https://github.com/ddollar/foreman">foreman</a></strong> to
run on your machine exactly as it does in production.
</div>

<p>It says it&#39;s listening, so let&#39;s navigate in our browser to <strong><a href="http://localhost:5000" target="_blank">localhost:5000</a></strong>
and see.</p>
<p><img src="img/new-app.png" alt="A newly initialied Poe UI app"></p>
<p>Great! We&#39;ve got a running app.</p>
</div></section><h2 id="basic-ui">Basic UI</h2><section id="basic-ui-section" class="basic-ui-section"><div id="structure" class="subsection"><h3>Structure</h3><p>Let's start by exploring how the project is organized. Here is our current project's tree:</p><div class="filetree"><div class="filetree-help"><p>Hover over a file see more information.</p>
<p>Click a file to toggle the information on/off.</p>
</div><div class="filetree-code"><div class="grouping parent-3 configuration"><div class="grouping-single">Configuration</div><div class="line file configuration"><code class="indent">|-- </code><div class="text"><code class="text-code">.env</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file configuration">NODE_ENV=development
API_URL=http://localhost:5001
</div><p>An <code>.env</code> file controls your environment. Unlike other project files, it should not be
version controlled, as doing so may reveal sensitive information.</p>
<p>Your environment variables are the most fundamental values to your application, and in your Poe app it will likely
provide your api&#39;s url at the very least.</p>
<p>Example:</p>
<pre><code class="lang-shell">API_URL=http://localhost:5001
NODE_ENV=development
</code></pre>
<p>For more information, read Heroku&#39;s <a href="https://devcenter.heroku.com/articles/config-vars#example">write-up</a>.</p>
</div></div></div><div class="line file configuration"><code class="indent">|-- </code><div class="text"><code class="text-code">package.json</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file configuration">{
  &quot;name&quot;: &quot;PROJECT&quot;,
  &quot;version&quot;: &quot;0.1.0&quot;,
  &quot;description&quot;: &quot;DESCRIPTION&quot;,
  &quot;author&quot;: &quot;ORGANIZATION&quot;,
  &quot;main&quot;: &quot;app.js&quot;,
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;./node_modules/.bin/startup start&quot;
  },
  &quot;repository&quot;: {
    &quot;type&quot;: &quot;git&quot;,
    &quot;url&quot;: &quot;https://github.com/REPO&quot;
  },
  &quot;engines&quot;: {
    &quot;node&quot;: &quot;0.10.x&quot;,
    &quot;npm&quot;: &quot;1.x.x&quot;
  },
  &quot;dependencies&quot;: {
    &quot;poe-ui&quot;: &quot;^0.4.8&quot;,
    &quot;startup&quot;: &quot;^1.0.0&quot;,
    &quot;envs&quot;: &quot;^0.1.4&quot;
  }
}</div><p>The <code>package.json</code> is the configuration file for any node project.</p>
<p>For more information, check out <strong><code>npm help json</code></strong>.</p>
</div></div></div><div class="line file configuration show"><code class="indent">|-- </code><div class="text"><code class="text-code">component.json</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file configuration show">{
  &quot;name&quot;: &quot;PROJECT&quot;,
  &quot;repository&quot;: &quot;REPO&quot;,
  &quot;description&quot;: &quot;DESCRIPTION&quot;,
  &quot;version&quot;: &quot;0.1.0&quot;,
  &quot;dependencies&quot;: {
    &quot;poegroup/poe-ui&quot;: &quot;^0.4.15&quot;,
    &quot;camshaft/component-angular&quot;: &quot;NG_VERSION&quot;,
    &quot;camshaft/component-angular-route&quot;: &quot;NG_VERSION&quot;
  }
}</div><p><a href="http://component.github.io/">Component</a> is a static asset tool. It&#39;s a dependency manager, distributor
as well as a general-purpose task runner. You can think of it as <a href="https://www.npmjs.com">npm</a> for all
things static: javascript, styles, images, fonts, etc.</p>
<p>To install, update, or remove components from your project, you can either</p>
<ul>
<li>edit your project&#39;s <code>component.json</code> file by hand (probably simpler)</li>
<li>or use the component <a href="https://github.com/componentjs/guide/blob/master/component/getting-started.md">CLI</a></li>
</ul>
<p>You don&apos;t have to worry about actually building the components however; when Poe UI run, it watches for changes
to your <code>component.json</code> and will install/remove/rebuild as necessary.</p>
<p>As far as structure goes, the <code>component.json</code> works almost identically to npm&apos;s <code>package.json</code>.</p>
<div class='.NOTE'>
Component pushed the community in a much more modular direction in 2012 - 2014, but has fallen out of popularity as
npm is becoming the standard for front- and back-end JS management. In the upcoming stable version of Poe UI this file
is replaced entirely by npm.
</div>

</div></div></div></div><div class="grouping parent-3 boilerplate"><div class="grouping-single">Boilerplate</div><div class="line file boilerplate"><code class="indent">|-- </code><div class="text"><code class="text-code">Makefile</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file boilerplate">include ./node_modules/poe-ui/tasks.mk
</div><p>Make is Poe&#39;s dependency tracker for builds during development
and in productions. Although it doesn&#39;t actually watch files when
they change, it determines which files rely on which, and how to
build as effectively as possible.</p>
<p>Since Poe app&#39;s have a consistent structure, the poe-ui module
keeps it&#39;s own <code>mk</code> file which is the called by your Poe app&#39;s
Makefile when you first start. So although Make has some
complex tasks under the covers, you only need one line on your
Makefile.</p>
<p>This file may be going away in a future release of Poe as we
keep simplifying.</p>
<p>If you&#39;re interested in Make at all (and who isn&#39;t?), here is the
<a href="https://github.com/poegroup/poe-ui-kit/blob/master/build.mk">files that does the heavy lifting in of Poe&#39;s builds</a>.</p>
</div></div></div><div class="line file boilerplate"><code class="indent">|-- </code><div class="text"><code class="text-code">Procfile.dev</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file boilerplate">web: ./node_modules/.bin/startup start
debug: ./node_modules/.bin/startup start --debug
</div><p>Heroku&#39;s <code>foreman</code> references this. Generally, it does not need to be touched.</p>
<p>For more information, check out <strong><a href="https://devcenter.heroku.com/articles/procfile">Heroku&#39;s docs</a></strong>.</p>
<div class='NOTE'>
This file is going away in the upcoming release.
</div>
</div></div></div><div class="line file boilerplate"><code class="indent">|-- </code><div class="text"><code class="text-code">app.js</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file boilerplate">/**
 * Expose the application.
 */

var app = module.exports = require('poe-ui')();
</div><p>This is the node.js entry point for your UI application. 
It instanciaties a new <strong>poe-ui</strong> application with some high-level configuration (including
setting the API namespace to <strong>/api</strong> by default).</p>
</div></div></div></div><div class="grouping parent-1"><div class="grouping-single">  </div><div class="line file"><code class="indent">|-- </code><div class="text"><code class="text-code ignored">public</code></div></div></div><div class="grouping parent-3 javascript"><div class="grouping-single">Javascript</div><div class="line file"><code class="indent">|   |-- </code><div class="text"><code class="text-code">javascripts</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"></div></div></div><div class="line file"><code class="indent">|   |   |-- </code><div class="text"><code class="text-code">index.js</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file">/**
 * Module dependencies
 */

var App = require('poe-ui');

/**
 * Expose the app
 */

var app = module.exports = App('PROJECT');

/**
 * Load plugins here with the 'use' method:
 *
 *   app.use(require('modal'));
 *
 */
</div><p>This is the entry point for the front-end builder.</p>
</div></div></div><div class="line file"><code class="indent">|   |   `-- </code><div class="text"><code class="text-code">routes.js</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file">/**
 * Expose the app routes
 */

module.exports = {
  '/': 'index'
};
</div><p>This is where to handle your client-side routing. We&#39;ll get to it later;
all you need to know right now is that our index is mounted on the root.</p>
</div></div></div></div><div class="grouping parent-3 partials"><div class="grouping-single">Partials</div><div class="line file markup"><code class="indent">|   |-- </code><div class="text"><code class="text-code">partials</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><p>The <code>partials</code> directory contains Jade files which are compiled by node to HTML and delivered to the client in the form of
Angular template in the <code>build/app.js</code>. This leaves only a tiny footprint on the client and frees the server up from having
to manage a template runtime.</p>
<p>For more information on Jade, check out <strong><a href="http://jade-lang.com/">the docs</a></strong>.</p>
</div></div></div><div class="line file markup"><code class="indent">|   |   |-- </code><div class="text"><code class="text-code">header.jade</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file markup">h1 PROJECT
</div></div></div></div><div class="line file markup"><code class="indent">|   |   `-- </code><div class="text"><code class="text-code">index.jade</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file markup">extends ../node_modules/poe-ui/views/layout

block body
  header(data-ng-include, src=&quot;'/partials/header.jade'&quot;)
  main(data-ng-view=&quot;&quot;)
</div></div></div></div></div><div class="grouping parent-2 styles"><div class="grouping-single">Styles</div><div class="line file styles"><code class="indent">|   `-- </code><div class="text"><code class="text-code">stylesheets</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"></div></div></div><div class="line file styles"><code class="indent">|       `-- </code><div class="text"><code class="text-code">index.styl</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file styles">// define core styles

html
  font-family sans-serif

body
body &gt; div
  height 100%
  width 100%

body
  position absolute
  margin 0
  text-align center
  &gt; div
    display flex
    flex-direction column
    justify-content center

h1
  font-weight 100
  margin-top 0

a
  padding 10px
</div></div></div></div></div><div class="grouping parent-2 view"><div class="grouping-single">View</div><div class="line file"><code class="indent">`-- </code><div class="text"><code class="text-code">views</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"></div></div></div><div class="line file"><code class="indent">    `-- </code><div class="text"><code class="text-code">index.jade</code><input type="checkbox" hidden class="text-checkbox"><div class="inner"><div class="raw-file">extends ../node_modules/poe-ui/views/layout

block body
  header(data-ng-include, src=&quot;'/partials/header.jade'&quot;)
  main(data-ng-view=&quot;&quot;)
</div><p>This is the &#39;chrome&#39; for our app, i.e., the area surrounding the app that remains
the same. The <code>main</code> element is where our <strong><code>public/partials/index.jade</code></strong> is loaded.</p>
<p>To include another partial (like a footer), simply point to the path in the <code>src</code> attribute
of an element as the <strong><code>header</code></strong> does here.</p>
<div class='NOTE'>
Note that the path is wrapped in double quotations (&quot;&#39;path/here&#39;&quot;).
</div>

<p>For more information on Jade, check out <strong><a href="http://jade-lang.com/">the docs</a></strong>.</p>
</div></div></div></div></div></div></div><div id="markup" class="subsection"><h3>Markup</h3><p>Now that we have a lay of the land, maybe we should edit a file.
Since this will be a UI app most of our time in this project will
be spent in the <code>public</code> directory.</p>
<p>Let&#39;s change the header text from &#39;my-app&#39; to... what? What does this
app even do? Well, in accordance with front-end law, any library that
is capable of running a todo list <em>must</em> demonstrate a todo list app;
so that&#39;s what we&#39;ll do.</p>
<p>Let&#39;s open the <code>public/partials/header.jade</code> file, and change</p>
<pre><code class="lang-sh">h1 my-app
</code></pre>
<p>to</p>
<pre><code class="lang-sh">h1 Todo
</code></pre>
<p>Once the file is saved, your browser should automatically update. This is true when
you edit any files in the app, with the exception of the <code>.env</code> file; editting the <code>.env</code>
<em>will</em> require restarting the server.</p>
<p>The browser should now look like this:</p>
<p><img src="img/rename.png" alt="New header"></p>
</div><div id="styles" class="subsection"><h3>Styles</h3><p>Poe uses <a href="http://learnboost.github.io/stylus/">Stylus</a> to preprocess its stylesheets.
Although Stylus is the most feature-rich CSS preprocessor (compared to LESS and SASS),
vanilla CSS is still syntactically correct, so you may choose to make use of Stylus&#39;s
features or not. Up to you. In this tutorial, we will.</p>
<p>We&#39;ll also use the <strong><a href="https://github.com/shoelace-ui/aglet">aglet</a></strong> framework and
the <strong><a href="https://github.com/tj/nib">nib</a></strong> helper library. To install, run the following
in your application root:</p>
<pre><code>npm i --save shoelace-ui-aglet nib
</code></pre><p>There we go. We can now <code>@require</code> these from our stylesheet.</p>
<div class='NOTE'>
To learn more about <code>@require</code>, check out the <a href="http://learnboost.github.io/stylus/docs/import.html">Stylus documentation</a>.
</div>

<p>So let&#39;s bring them in and while we&#39;re at it, add some styles. How about we frame our app
in gray against a white background?</p>
<p>Open <code>public/stylesheets/index.styl</code> and change</p>
<pre><code>// define core styles

html
  font-family sans-serif

body
body &gt; div
  height 100%
  width 100%

body
  position absolute
  margin 0
  text-align center
  &gt; div
    display flex
    flex-direction column
    justify-content center

h1
  font-weight 100
  margin-top 0

a
  padding 10px
</code></pre><p>to</p>
<pre><code>// variables

input--apply-all = true

// dependencies

@require &#39;shoelace-ui-aglet&#39;
@require &#39;nib&#39;

// core styles

html
  font-family sans-serif
  font-size 14px

body
  height 100%
  width 100%
  background rgba(black, .1)
  position absolute
  margin 0

body &gt; div
  background rgba(white .9)
  box-shadow 0 2px 6px 0 rgba(black, 0.2), 0 5px 50px 0 rgba(black, 0.15)
  box-sizing border-box
  display flex
  flex-direction column
  max-width 500px
  padding padding--extra-large
  margin @padding auto
  width 100%

h1
  font-weight 100
  margin-top 0
  text-align center

a
  padding-right 10px
</code></pre><div class='NOTE'>
<p>
If this is the first time you&#39;ve seen the <code>rem</code> unit, you can <strong><a href="http://snook.ca/archives/html_and_css/font-size-with-rem">read about it here</a></strong>.
</p>
<p>
With the <code>@</code> sigil, we&#39;re making use of Stylus&#39;s <strong><a href="http://learnboost.github.io/stylus/docs/variables.html#property-lookup">property lookup</a></strong>
feature.
</p>
<p>
We&#39;re also using the Stylus builtin <strong><a href="http://learnboost.github.io/stylus/docs/bifs.html#alphacolor-value">rgba</a></strong> to write colors.
</p>
</div>

<p>Our Todo app should look like this now:</p>
<p><img src="img/background.png" alt="New background"></p>
</div><div id="routes" class="subsection"><h3>Routes</h3><p>So we know how to edit markup and change styles. Now what? So far our app
is basically a glorified static page.</p>
<p>Let&#39;s add a login page to see how routing works.</p>
<p>First, let&#39;s write <code>public/partials/login.jade</code> as</p>
<pre><code>form
  input(type=&#39;text&#39; placeholder=&#39;username&#39;)
  input(type=&#39;password&#39; placeholder=&#39;password&#39;)
</code></pre><p>And we&#39;ll change <code>public/javascripts/routes.js</code> from</p>
<pre><code>module.exports = {
  &#39;/&#39;: &#39;index&#39;
};
</code></pre><p>to</p>
<pre><code>module.exports = {
  &#39;/&#39;: &#39;index&#39;,
  &#39;/login&#39;: &#39;login&#39;
};
</code></pre><p>The <code>/login</code> key is the path, and the value is the partial to which the
router should point. In this case, going to <a href="localhost:5000/login">localhost:5000/login</a> should
show us the form at the <code>login.jade</code> partial. Let&#39;s see:</p>
<p><img src="img/login.png" alt="Login page"></p>
<p>Perfect!</p>
<p>But to create an actual login, we&#39;ll need to set up an API.</p>
</div></section><h2 id="basic-api">Basic API</h2><section id="basic-api-section" class="basic-api-section"><div id="initializing" class="subsection"><h3>Initializing</h3><p>Let&#39;s navigate to a new directory like we did earlier.</p>
<pre><code>mkdir -p ~/Projects/mndvns/todo-api
cd ~/Projects/mndvns/todo-api
poe create api
</code></pre><p>Once again, we&#39;re asked to fill some project fields. Let&#39;s use the following values:</p>
<pre><code>project: todo-api
description: todo api
port: 5001
</code></pre><p>And the confirmation should resemble </p>
<pre><code>{
  &quot;project&quot;: &quot;todo-api&quot;,
  &quot;username&quot;: &quot;mndvns&quot;,
  &quot;email&quot;: &quot;mail@mndvns.com&quot;,
  &quot;fullname&quot;: &quot;Michael Andrew Vanasse&quot;,
  &quot;description&quot;: &quot;todo api&quot;,
  &quot;PORT&quot;: &quot;5001&quot;
}
</code></pre><p>Just like before, let&#39;s run</p>
<pre><code>make start
</code></pre><p>Once it&#39;s running, we&#39;ll check out <a href="http://localhost:5001">localhost:5001</a> and see</p>
<p><img src="img/new-api.png" alt="Our new API"></p>
<div class='NOTE'>
If you&#39;re using Chrome, I highly encourage getting the <a href="https://chrome.google.com/webstore/detail/hyperchrome/micpjacfpmndnocgeldgmhdgjeaiokhk">hyper.chrome</a>
extension. It makes navigating hypermedia APIs easy and fun.
</div>

<p>Nice! So if everything&#39;s working right, we should be able to see this API mounted on our UI
under <code>/api</code>. Let&#39;s check...</p>
<p><img src="img/api-mounted.png" alt="API mounted properly"></p>
<p>Bam. Done and done.</p>
</div><div id="login" class="subsection"><h3>Login</h3><p>Let&#39;s have the api to serve a login form and a signup form on <code>/</code>. Change <code>api.js</code> from</p>
<pre><code>api.get(&#39;/&#39;, function(req, res, next) {
  res.json({
    app: {
      name: &#39;todo-api&#39;,
      description: &#39;todo api&#39;,
      author: {href: req.base + &#39;/author&#39;}
    }
  });
});
</code></pre><p>to</p>
<pre><code>api.get(&#39;/&#39;, function(req, res) {
  res.json({
    signup: {
      method: &#39;POST&#39;,
      action: req.base,
      input: {
        _action: {
          type: &#39;hidden&#39;,
          value: &#39;signup&#39;
        },
        username: {
          type: &#39;text&#39;,
          required: true
        },
        password: {
          type: &#39;password&#39;,
          required: true
        },
        &#39;first-name&#39;: {
          type: &#39;text&#39;,
          placeholder: &#39;first name&#39;
        },
        &#39;last-name&#39;: {
          type: &#39;text&#39;,
          placeholder: &#39;last name&#39;
        }
      }
    },
    login: {
      method: &#39;POST&#39;,
      action: req.base,
      input: {
        _action: {
          type: &#39;hidden&#39;,
          value: &#39;login&#39;
        },
        username: {
          type: &#39;text&#39;,
          required: true
        },
        password: {
          type: &#39;password&#39;,
          required: true
        }
      }
    }
  });
});
</code></pre><p>Take a look: we&#39;re giving back two forms: <code>login</code> and <code>signup</code>, each of which
submit a <code>POST</code> to our root, <code>/</code>. But if we submit the forms now, we wouldn&#39;t get any
response; we need to add endpoints in our API for <code>POST /</code>.</p>
<p>Let&#39;s add the following lines to our <code>api.js</code>:</p>
<pre><code>api.post(&#39;/&#39;, function(req, res, next) {
  var b = req.body;
  if (b._action === &#39;login&#39;) return next(&#39;route&#39;);
  if (!b.username || !b.password) return res.send(400);

  // TODO
  // save user then
  // redirect to user page

});

api.post(&#39;/&#39;, function(req, res, next) {
  var b = req.body;
  var username = b.username;
  if (!username) return res.send(400);

  // TODO
  // find user then
  // verify credentials
  // redirect to user page

});
</code></pre><p>Obviously, this still won&#39;t work. We need some way of storing our users. Let&#39;s use <a href="http://mongoosejs.com/">mongoose.js</a>.</p>
</div><div id="mongoose" class="subsection"><h3>Mongoose</h3><p>In our app&#39;s root, run</p>
<pre><code>npm i --save mongoose
</code></pre><p>And make sure you have <a href="http://www.mongodb.org/downloads">mongodb</a> installed, then
go to a fresh terminal and run</p>
<pre><code>mongod
</code></pre><div class='NOTE'>
If you&#39;re on OS X, install mongo via
<pre><code>
brew install mongodb
</pre></code>
</div>

<p>Now, at the top of <code>api.js</code> right under <code>var api = ...</code> around line 14, add</p>
<pre><code>var mongoose = require(&#39;mongoose&#39;);
mongoose.connect(&#39;mongodb://localhost/todo-api&#39;);

var Schema = mongoose.Schema;
var ObjectID = Schema.ObjectId;

var UserS = new Schema({
  username: String,
  password: String,
  firstName: String,
  lastName: String
});

var User = mongoose.model(&#39;User&#39;, UserS);

api.param(&#39;user&#39;, function(req, res, next, id) {
  req.userBase = req.base + &#39;/&#39; + id;
  User.findById(id, function(err, user) {
    if (err) return next(err);
    if (!user) return res.send(404);
    res.locals.user = user;
    next();
  });
});
</code></pre><p>And back at our <code>POST /</code> endpoints, we can add the user handling like so:</p>
<pre><code>api.post(&#39;/&#39;, function(req, res, next) {
  var b = req.body;
  if (b._action === &#39;login&#39;) return next(&#39;route&#39;);
  if (!b.username || !b.password) return res.send(400);
  var user = new User(bodyToUser(b));
  user.save(function(err) {
    if (err) return next(err);
    res.redirect(req.base + &#39;/&#39; + user._id);
  });
});

api.post(&#39;/&#39;, function(req, res, next) {
  var b = req.body;
  var username = b.username;
  if (!username) return res.send(400);
  User.find({username: username}, function(err, users) {
    if (err) return next(err);
    if (!users || !users[0]) return res.send(404);
    var user = users[0];
    if (user.password !== b.password) return res.send(401);
    res.redirect(req.base + &#39;/&#39; + user._id);
  });
});
</code></pre><p>So let&#39;s try it out! If you got the <a href="https://chrome.google.com/webstore/detail/hyperchrome/micpjacfpmndnocgeldgmhdgjeaiokhk">hyper.chrome extension</a>,
you can actually fill and submit forms right in the browser. Let&#39;s try it.</p>
<p>Go to <a href="http://localhost:5000/api">localhost:5000/api</a> and fill out the <code>signup</code> form for</p>
<pre><code>username: rambo
password: 123
first name: John
last name: Rambo
</code></pre><p><img src="img/api-signup.png" alt="First user signup"></p>
<p>Now let&#39;s use mongo&#39;s command-line tool to query the database and see if we succeeded. In a new terminal, run</p>
<pre><code>mongo
</code></pre><p>This is mongo&#39;s interactive shell. If we check our database for users...</p>
<pre><code>&gt; use todo-api
switched to db todo-api
&gt; db.users.find({}).toArray()
[
        {
                &quot;_id&quot; : ObjectId(&quot;54c703a9ea6c44c06a625044&quot;),
                &quot;username&quot; : &quot;rambo&quot;,
                &quot;firstName&quot; : &quot;John&quot;,
                &quot;lastName&quot; : &quot;Rambo&quot;,
                &quot;password&quot; : &quot;123&quot;,
                &quot;__v&quot; : 0
        }
]
&gt;
</code></pre><p>Booya! We have out first user, John Rambo.</p>
</div></section><h2 id="appendix">Appendix</h2><section id="appendix-section" class="appendix-section"><div id="organizations" class="subsection"><h3>Organizations</h3><h4 id="-poegroup-https-github-com-poegroup-"><a href="https://github.com/poegroup">poegroup</a></h4>
<p>Poegroup&#39;s focus is on all things web-related in order to provide a robust, production-ready
environment for developers that is simple and easy to learn.</p>
<h4 id="-hypergroup-https-github-com-hypergroup-"><a href="https://github.com/hypergroup">hypergroup</a></h4>
<p>Hypergroup&#39;s focus is on developing hypermedia tools, best practices, and community.
Hypergroup handles the <a href="https://github.com/hypergroup/hyper-json">hyper+json</a> spec
and a number of hyper+json clients, including <a href="https://github.com/hypergroup/ng-hyper">ng-hyper</a>,
an angular.js client and <a href="https://github.com/hypergroup/hyper.chrome">hyper.chrome</a>, an in-browser
JSON navigator and debugger.</p>
<h4 id="-shoelace-http-github-com-shoelace-ui-"><a href="http://github.com/shoelace-ui">shoelace</a></h4>
<p>Shoelace is focused on reusable design in CSS and the DOM. The
<a href="https://github.com/shoelace-ui/aglet">aglet</a> framework provides a bootrap-like
framework with a bottom-up approach. Shoelace also manages tools for colors, font, and icons.</p>
<h4 id="-lang-js-http-github-com-lang-js-"><a href="http://github.com/lang-js">lang-js</a></h4>
<p>A collection of language manipulation tool for browsers and node.js.</p>
<h4 id="-directiv-http-github-com-directiv-"><a href="http://github.com/directiv">directiv</a></h4>
</div><div id="resources" class="subsection"><h3>Resources</h3><ul>
<li><p><a href="http://hypergroup.github.io/ng-hyper">ng-hyper</a></p>
<p>an introduction to ng-hyper</p>
</li>
<li><p><a href="https://github.com/hypergroup/hyper-json">hyper+json</a></p>
<p>the hyper+json spec</p>
</li>
<li><p><a href="https://github.com/hypergroup/hyper.chrome">hyper.chrome</a></p>
<p>a very useful Chrome extension for APIs</p>
</li>
<li><p><a href="https://chrome.google.com/webstore/detail/angularjs-batarang/ighdmehidhipcmcojjgiloacoafjmpfk?hl=en">batarang</a></p>
<p>a useful Chrome extension for Angular.js</p>
</li>
</ul>
</div></section><script>var REVEAL_TIME = 2000;

var fileContent = document.createElement('div');
fileContent.className = 'filetree-content';
var subsection = document.body.querySelector('.filetree');
subsection.appendChild(fileContent);
var fileHelp = document.querySelector('.filetree-help');

var lines = document.querySelectorAll('.line .text-code');
var arr = [];
for(var i = 0; i < lines.length; i++) arr[i] = lines[i];

arr.forEach(function(line, idx){
  line = arr[idx];
  if (~line.className.indexOf('ignored')) return;
  var content = line.parentElement.children[line.parentElement.children.length - 1]
  if (content.className !== 'inner') content = false;
  else fileContent.appendChild(content);

  line.addEventListener('mouseenter', toggle);
  line.addEventListener('mouseleave', toggle);
  line.addEventListener('click', toggle);

  function toggle(ev) {
    var box = ev.target.nextElementSibling;
    var parent = ev.target.parentElement;
    var parentActive = ~parent.className.indexOf('active');
    if (ev.type === 'click') box.checked = !box.checked;
    if (ev.type === 'mouseleave' && !box.checked && parentActive) activate(parent);
    if (ev.type === 'mouseenter' && !parentActive) deactivate(parent);
  }

  var timeout;

  function activate(el) {
    el.className = 'text';
    content.className = 'inner';
    fileHelp.className = 'filetree-help hidden'
  }

  function deactivate(el) {
    el.className = 'text active';
    content.className = 'inner active';
    reset();
  }

  function clear() {
    fileHelp.className = 'filetree-help hidden'
    window.clearTimeout(timeout);
    timeout = false;
  }

  function reset() {
    clear();
    timeout = window.setTimeout(reveal, REVEAL_TIME);
  }

  function reveal() {
    var active = document.querySelectorAll('.filetree-content .active')
    if (active.length) return;
    fileHelp.className = 'filetree-help'
  }
});
</script></main></body><script>window.quotes = [{":c":"The string is a stark data structure and everywhere it is passed there is much duplication of process. It is a perfect vehicle for hiding information.",":a":"Alan J. Perlis"},{":c":"We are on the verge: Today our program proved Fermat's next-to-last theorem.",":a":"Alan J. Perlis"},{":c":"People who deal with bits should expect to get bitten.",":a":"Jon Bentley"},{":c":"Fight code entropy.",":a":"John Carmack"},{":c":"Let the code run free, if it needs to be debugged, it will come back."},{":c":"It should be noted that no ethically-trained software engineer would ever consent to write a DestroyBaghdad procedure. Basic professional ethics would instead require him to write a DestroyCity procedure, to which Baghdad could be given as a parameter.",":a":"Nathaniel S Borenstein"},{":c":"It's difficult to extract sense from strings, but they're the only communication coin we can count on.",":a":"Alan J. Perlis"},{":c":"Artificial Intelligence is no match for natural stupidity."},{":c":"Recursion is the root of computation since it trades description for time.",":a":"Alan J. Perlis"},{":c":"There are 10 types of people. Those who can read ternary, those who can't and those who mistake it for binary."},{":c":"It is often easier to not do something dumb than it is to do something smart."},{":c":"If our customers wanted a product that worked that way, tell them to purchase a product that works that way."},{":c":"'Goto' is always evil, like in 'goto school' or 'goto work'.\n"},{":c":"Beware of bugs in the above code; I have only proved it correct, not tried it.",":a":"Donald Knuth"},{":c":"If architects built houses the way programmers built programs, the first woodpecker to come along would destroy civilization.",":a":"Gerald Weinberg"},{":c":"In software systems, it is often the early bird that makes the worm.",":a":"Alan J. Perlis"},{":c":"If you've seen one picture of the Mandelbrot Set, you've seen them all.",":a":"Bill Karwin"},{":c":"Question: How does a large software project get to be one year late? Answer: One day at a time!",":a":"Fred Brooks"},{":c":"Like wine, the mastery of programming matures with time. But, unlike wine, it gets sweeter in the process.",":a":"Lawrence Mucheka"},{":c":"Yes, sometimes Perl looks like line noise to the uninitiated, but to the seasoned Perl programmer, it looks like checksummed line noise with a mission in life.",":a":"Randal Schwartz"},{":c":"You can stand on the shoulders of giants OR a big enough pile of dwarfs, works either way."},{":c":"You have to \"solve\" the problem once in order to clearly define it and then solve it again to create a solution that works.\n"},{":c":"Programmer - an organism that turns coffee into software."},{":c":"If I have not seen as far as others, it is because giants were standing on my shoulders.",":a":"Hal Abelson"},{":c":"Systems have sub-systems and sub-systems have sub- systems and so on ad infinitum - which is why we're always starting over.",":a":"Alan J. Perlis"},{":c":"Re graphics: A picture is worth 10K words - but only those to describe the picture. Hardly any sets of 10K words can be adequately described with pictures.",":a":"Alan J. Perlis"},{":c":"Confidence, n.: The feeling you have before you understand the situation."},{":c":"An expert is a man who has made all the mistakes that can be made in a very narrow field.",":a":"Niels Bohr"},{":c":"It's hard to read through a book on the principles of magic without glancing at the cover periodically to make sure it isn't a book on software design.",":a":"Bruce Tognazzini"},{":c":"UNIX is basically a simple operating system, but you have to be a genius to understand the simplicity.",":a":"Dennis Ritchie"},{":c":"I think there's a world market for about five computers.",":a":"Thomas J Watson Senior, 1945"},{":c":"The evolution of languages: FORTRAN is a non-typed language. C is a weakly typed language. Ada is a strongly typed language. C++ is a strongly hyped language.",":a":"Ron Sercely"},{":c":"The difference between theory and practice is smaller in theory than in practice."},{":c":"Good programmers never write what they can steal or borrow.",":a":"Jeff Atwood"},{":c":"If architects built houses the way programmers built programs, the first woodpecker to come along would destroy civilization.",":a":"Gerald Weinberg"},{":c":"We kid ourselves if we think that the ratio of procedure to data in an active data-base system can be made arbitrarily small or even kept small.",":a":"Alan J. Perlis"},{":c":"The only valid measurement of code quality: WTFs / minute",":a":"Thom Holwerda"},{":c":"One man's constant is another man's variable.",":a":"Alan J. Perlis"},{":c":"If you can imagine a society in which the computer - robot is the only menial, you can imagine anything.",":a":"Alan J. Perlis"},{":c":"The time machine's software will have a recursive main method."},{":c":"Question: How does a large software project get to be one year late? Answer: One day at a time!",":a":"Fred Brooks"},{":c":"Confidence, n.: The feeling you have before you understand the situation."},{":c":"Code is everything I thought poetry was, back when we were in school. Clean, expressive, urgent, all-encompassing. Fourteen lines can open up to fill the available universe.",":a":"Richard Powers"},{":c":"The Floppy Disk Icon means \"save\" for a whole generation of people who have never seen one.\n",":a":"Scott Hanselman"},{":c":"If Java had true garbage collection, most programs would delete themselves upon execution.",":a":"Robert Sewell"},{":c":"If you don't think you're doing great things, you're probably right."},{":c":"Code reuse is the Holy Grail of Software Engineering.",":a":"Douglas Crockford"},{":c":"Education is the process of learning more and more about less and less until one knows everything about nothing and is entitled to call oneself 'Doctor'."},{":c":"Why did the Roman Empire collapse? What is Latin for office automation?",":a":"Alan J. Perlis"},{":c":"We kid ourselves if we think that the ratio of procedure to data in an active data-base system can be made arbitrarily small or even kept small.",":a":"Alan J. Perlis"},{":c":"The sooner we start coding fewer frameworks and more programs the sooner we'll become better programmers.",":a":"Warped Java Guy Elementary Java Solutions"},{":c":"Every revolutionary idea seems to evoke three stages of reaction: One, it's completely impossible. Two, it's possible, but it's not worth doing. Three, I said it was a good idea all along.",":a":"Arthur C. Clarke"},{":c":"If you have a procedure with ten parameters, you probably missed some.",":a":"Alan J. Perlis"},{":c":"In order to understand recursion, one must first understand recursion."},{":c":"If C didn't exist, we would be programming in OBOL, PASAL or BASI"},{":c":"It won't be covered in the book. The source code has to be useful for something, after all...",":a":"Larry Wall"},{":c":"Perl - The only language that looks the same before and after RSA encryption.",":a":"Keith Bostic"},{":c":"The most important computer is the one that rages in our skulls and ever seeks that satisfactory external emulator. The standarization of real computers would be a disaster - and so it probably won't happen.",":a":"Alan J. Perlis"},{":c":"The three chief virtues of a programmer are: Laziness, Impatience and Hubris.",":a":"Larry Wall"},{":c":"Deleted code is debugged code.",":a":"Jeff Sickel"},{":c":"Every dark corner you haven't explored with your flashlight is full of bugs.",":a":"Kent Beck and Martin Fowler"},{":c":"A good system can't have a weak command language.",":a":"Alan J. Perlis"},{":c":"An ideal world is left as an exercise to the reader.",":a":"From Paul Graham's \"On Lisp\""},{":c":"The time machine's software will have a recursive main method."},{":c":"80 percent of my problems are simple logic errors. 80 percent of the remaining problems are pointer errors. The remaining problems are hard.",":a":"Mark Donner, IBM Watson Research Center"},{":c":"The proof of a system's value is its existence.",":a":"Alan J. Perlis"},{":c":"Part of the inhumanity of the computer is that, once it is competently programmed and working smoothly, it is completely honest.",":a":"Isaac Asimov"},{":c":"You can't communicate complexity, only an awareness of it.",":a":"Alan J. Perlis"},{":c":"Debuggers don't remove bugs. They only show them in slow motion."},{":c":"Sex is fun, but it probably doesn't solve all your problems.",":a":"Larry Wall"},{":c":"Great things are not done by impulse, but by a series of small things brought together.",":a":"Vincent van Gogh"},{":c":"Human beings are not accustomed to being perfect, and few areas of human activity demand it. Adjusting to the requirement for perfection is, I think, the most difficult part of learning to program."},{":c":"Ever spend a little time reading comp.lang.c++ ? That's really the best place to learn about the number of C++ users looking for a better language.",":a":"R. William Beckwith"},{":c":"The third version is the first version that doesn't suck.",":a":"Mike Simpson"},{":c":"There are two ways of constructing a software design: One way is to make it so simple that there are obviously no deficiencies, and the other way is to make it so complicated that there are no obvious deficiencies. The first method is far more difficult.",":a":"C.A.R. Hoare."},{":c":"Process is no substitute for synaptic activity.",":a":"Jeff DeLuca"},{":c":"I have not failed. I've just found 10,000 ways that won't work.",":a":"Thomas A. Edison"},{":c":"He who hasn't hacked assembly language as a youth has no heart. He who does as an adult has no brain.",":a":"John Moore"},{":c":"An idiot with a computer is a faster, better idiot.",":a":"Rich Julius"},{":c":"Wherever there is modularity there is the potential for misunderstanding: Hiding information implies a need to check communication.",":a":"Alan J. Perlis"},{":c":"Jesus saves but only Buddha makes incremental backups."},{":c":"Any technology that surpasses 50% penetration will never double again (in any number of months).",":a":"Peter Norvig's law"},{":c":"If you can imagine a society in which the computer - robot is the only menial, you can imagine anything.",":a":"Alan J. Perlis"},{":c":"Like punning, programming is a play on words.",":a":"Alan J. Perlis"},{":c":"I have always wished for my computer to be as easy to use as my telephone; my wish has come true because I can no longer figure out how to use my telephone.",":a":"Bjarne Stroustrup"},{":c":"For every complex problem there is an answer that is clear, simple, and wrong.",":a":"H L Mencken"},{":c":"There are only 3 numbers of interest to a computer scientist: 1, 0 and infinity."},{":c":"The cybernetic exchange between man, computer and algorithm is like a game of musical chairs: The frantic search for balance always leaves one of the three standing ill at ease.",":a":"Alan J. Perlis"},{":c":"Python's syntax succeeds in combining the mistakes of Lisp and Fortran. I do not construe that as progress.",":a":"Larry Wall"},{":c":"Software is under a constant tension. Being symbolic it is arbitrarily perfectible; but also it is arbitrarily changeable.",":a":"Alan J. Perlis"},{":c":"There is nothing quite so permanent as a quick fix."},{":c":"We all agree on the necessity of compromise. We just can't agree on when it's necessary to compromise.",":a":"Larry Wall"},{":c":"All programs have at least one bug remaining and can be optimized by one byte. Thus, by mathematical induction, all programs can be reduced to one byte. And it won't work."},{":c":"Team debugging: the act of intimidating a PC into doing for two people what it refuses to do for one."},{":c":"There are 10 types of people. Those who can read ternary, those who can't and those who mistake it for binary."},{":c":"Programming is difficult. At its core, it is about managing complexity. Computer programs are the most complex things that humans make. Quality is illusive and elusive.",":a":"Douglas Crockford"},{":c":"There's a fine line between being on the leading edge and being in the lunatic fringe.",":a":"Frank Armstrong"},{":c":"If the automobile had followed the same development cycle as the computer, a Rolls-Royce would today cost $100, get a million miles per gallon, and explode once a year, killing everyone inside.",":a":"Robert X. Cringely"},{":c":"It is easier to change the specification to fit the program than vice versa.",":a":"Alan J. Perlis"},{":c":"In my experience, one of the most significant problems in software development is assuming. If you assume a method will passed the right parameter value, the method will fail.",":a":"Paul M. Duvall"}];// get one random quote
function randomQuote(){
  var obj = quotes[Math.floor(Math.random()*quotes.length)];
  document.querySelector('.quote-value').textContent = obj[':c'];
  if (!obj[':a']) return;
  document.querySelector('.quote-author').textContent = obj[':a'];
}

randomQuote();
</script></html>